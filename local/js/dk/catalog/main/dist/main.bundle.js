!function(e,t,a,n,o){"use strict";var i={name:"Category",props:{category:{type:Object,required:!0},activeCategories:{type:Array,required:!0},isSubcategory:{type:Boolean,required:!1,default:!1},showChildrenCategories:{type:Array,required:!0},start:{type:Boolean,required:!0},loading:{type:Boolean,required:!0},loadingCategory:{type:Number,required:!1}},data:function(){return{image:{src:!1,elementClass:!0}}},computed:{isNew:function(){return this.category.tags.new},isTagged:function(){return this.isNew},hasChildren:function(){return this.category.children.length>0},isActive:function(){return this.activeCategories.includes(this.category.id)},showChildren:function(){return this.showChildrenCategories.includes(this.category.id)},isLoading:function(){return this.category.id===this.loadingCategory},showArrow:function(){return!this.isLoading&&this.hasChildren}},emits:["onChangeActive"],methods:{changeActive:function(e,t){t&&"A"===t.target.tagName||this.loading||this.$emit("onChangeActive",e)},showEnter:function(e){var t=e.clientHeight;e.style.height=0,setTimeout((function(){return e.style.height=t+"px"}),0)},showAfterEnter:function(e){e.removeAttribute("style")},hideBeforeLeave:function(e){e.style.height=e.clientHeight+"px"},hideLeave:function(e){e.style.height=0}},mounted:function(){var e;e=this.isSubcategory?!!this.category.images.picture&&this.category.images.picture.src:this.category.icon,this.image={src:e,elementClass:"catalog-category__".concat(this.isSubcategory?"picture":"image")}},template:'\n<li>\n    <div \n    class="catalog-category"\n    :class="{\n    \'is-tagged\': isTagged,\n    \'is-tagged--new\': isNew,\n    \'is-active\': isActive,\n    \'catalog-category--min\': isSubcategory\n    }"\n    @click="changeActive(category, $event)"\n    >\n        <img \n        :src="image.src" \n        :class="image.elementClass"\n        alt="" \n        v-if="image.src">\n        <span class="catalog-category__label">\n            <a :href="category.url" class="catalog-category__link">{{ category.title }}</a>\n        </span>\n        <span class="loader loader--blue" v-if="isLoading"></span>\n        <span class="catalog-category__arrow catalog-category__arrow--down" v-if="showArrow"></span>\n    </div>\n    <transition\n        @enter="showEnter"\n        @after-enter="showAfterEnter"\n        @before-leave="hideBeforeLeave"\n        @leave="hideLeave"\n        name="vertical-slide"\n    >\n        <ul \n        class="catalog-categories__children"\n        :class="{\'catalog-categories__children--not-transform\': start}"\n        v-if="hasChildren && showChildren"\n        >\n            <Category \n            v-for="subcategory in category.children"\n            :category="subcategory"\n            :start="start"\n            :loading="loading"\n            :activeCategories="activeCategories"\n            :showChildrenCategories="showChildrenCategories"\n            :isSubcategory="true"\n            :loadingCategory="loadingCategory"\n            :key="subcategory.id"\n            @onChangeActive="changeActive"\n            ></Category>\n        </ul>\n    </transition>\n</li>\n'},r={name:"Categories",props:{categories:{type:Array,required:!0},activeCategories:{type:Array,required:!0},showChildrenCategories:{type:Array,required:!0},start:{type:Boolean,required:!0},loading:{type:Boolean,required:!0},loadingCategory:{type:Number,required:!1}},data:function(){return{}},emits:["onChangeActive"],methods:{changeActive:function(e){this.$emit("onChangeActive",e)}},components:{Category:i},template:'\n<ul class="catalog-categories scroll" ref="catalogCategories">\n    <Category \n    v-for="category in categories"\n    :category="category"\n    :activeCategories="activeCategories"\n    :showChildrenCategories="showChildrenCategories"\n    :loadingCategory="loadingCategory"\n    :start="start"\n    :loading="loading"\n    :key="category.id"\n    @onChangeActive="changeActive"\n    ></Category>\n</ul>\n'},s={name:"MobileCategories",props:{category:{type:Object,required:!0},opened:{type:Boolean,required:!0}},computed:{isRoot:function(){return!this.category.parent},image:function(){return this.isRoot?this.category.icon:!!this.category.images.picture&&this.category.images.picture.src},isNew:function(){return!!this.category.tags&&this.category.tags.new},isTagged:function(){return this.isNew}},emits:["onMobileCatalogOpen"],methods:{showTree:function(e){"a"!==e.target.tagName.toLowerCase()&&this.$emit("onMobileCatalogOpen")}},template:'\n<div class="catalog-mobile-categories" :class="{\'is-hidden\': opened}" ref="mobileOpener">\n    <button \n    class="catalog-category is-active"\n    :class="{\n    \'is-tagged\': isTagged,\n    \'is-tagged--new\': isNew,\n    \'catalog-category--min\': !isRoot\n    }"\n    @click="showTree"\n    >\n        <img :src="image" alt="" :class="{\'catalog-category__image\': isRoot, \'catalog-category__picture\': !isRoot}" v-if="image">\n        <span class="catalog-category__label">\n            <a :href="category.url" class="catalog-category__link">{{ category.title }}</a>\n        </span>\n        <span class="catalog-category__arrow catalog-category__arrow--down"></span>\n    </button>\n</div>\n'};BX.ready((function(){BX.ajax.runComponentAction("dk:catalog","getTree",{mode:"class"}).then((function(e){BX.ajax.runComponentAction("dk:catalog","getProducts",{mode:"class",data:{pageSize:6,page:1,sectionId:e.data[0].id}}).then((function(t){BX.Vue3.createApp({name:"MainCatalog",data:function(){return{start:!0,catalog:e.data,activeSectionIdPath:[],categoryWithLoader:0,showSectionIdPath:[],activeCategory:{},loading:!1,page:{size:6,current:1},lang:{closeMobile:BX.message.DK_CATALOG_MAIN_CLOSE_MOBILE},catalogBtn:{title:BX.message.DK_CATALOG_MAIN_GO_TO_TITLE,url:BX.message.DK_CATALOG_MAIN_GO_TO_URL},products:t.data,mobileOpened:!1}},emits:["onChangeActive"],watch:{mobileOpened:function(e){e?o.Methods.toggleBodyOverflow():o.Methods.toggleBodyOverflow(!1)}},methods:{changeActive:function(e){var t=this;this.loading=!0,this.categoryWithLoader=e.id,BX.ajax.runComponentAction("dk:catalog","getProducts",{mode:"class",data:{pageSize:this.page.size,page:1,sectionId:e.id}}).then((function(a){t.page.current=1,t.activeCategory=e,t.products=a.data;var n=!t.showSectionIdPath.length,o=t.activeSectionIdPath.includes(e.id);t.activeSectionIdPath=[],t.showSectionIdPath=[],t.calculateActiveIdPath(e),t.activeSectionIdPath.reverse(),t.showSectionIdPath.reverse(),o&&(n||t.showSectionIdPath.pop(),e.parent&&t.activeSectionIdPath.pop()),t.loading=!1,t.categoryWithLoader=0}))},setCatalogParents:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.parent=a,e.children.map((function(a){return t.setCatalogParents(a,e)}))},calculateActiveIdPath:function(e){this.activeSectionIdPath.push(e.id),this.showSectionIdPath.push(e.id),e.parent&&this.calculateActiveIdPath(e.parent)},changeCurrentPage:function(e){var t=this;this.loading=!0,BX.ajax.runComponentAction("dk:catalog","getProducts",{mode:"class",data:{pageSize:this.page.size,page:e,sectionId:this.activeCategory.id}}).then((function(a){t.products=a.data,t.page.current=e,t.loading=!1}))},mobileCatalogOpen:function(){this.mobileOpened||(this.mobileOpened=!0,this.toggleHeaderAfterScrollEnd(!0),window.scroll({top:this.$refs.mobileButton.$refs.mobileOpener.getBoundingClientRect().top+window.pageYOffset,behavior:"smooth"}))},toggleHeaderAfterScrollEnd:function(e){var t=document.getElementById("fixedHeader");t&&(e?t.classList.add("is-disabled"):t.classList.remove("is-disabled"))},closeMobileCatalog:function(){this.mobileOpened=!1,this.toggleHeaderAfterScrollEnd(!1)}},updated:function(){this.$refs.categories.$refs.catalogCategories.style.height=this.$refs.catalogMain.clientHeight+"px"},mounted:function(){var e=this;this.catalog.map((function(t){return e.setCatalogParents(t)})),this.activeSectionIdPath.push(this.catalog[0].id),this.showSectionIdPath.push(this.catalog[0].id),this.activeCategory=this.catalog[0],this.start=!1},components:{Categories:r,Product:a.Product,Pagination:n.Pagination,MobileCategories:s},template:'\n                            <MobileCategories\n                            :category="activeCategory"\n                            :opened="mobileOpened"\n                            @onMobileCatalogOpen="mobileCatalogOpen"\n                            ref="mobileButton"\n                            ></MobileCategories>\n                            <div class="catalog-categories-outer" :class="{\'is-active\': mobileOpened}">\n                                <Categories \n                                :categories="catalog" \n                                :activeCategories="activeSectionIdPath"\n                                :showChildrenCategories="showSectionIdPath"\n                                :loadingCategory="categoryWithLoader"\n                                :start="start"\n                                :loading="loading"\n                                @onChangeActive="changeActive"\n                                ref="categories"\n                                ></Categories>\n                                <button \n                                class="button button--bordered button--100 button--white mobile-catalog-categories-closer"\n                                @click="closeMobileCatalog"\n                                >{{ lang.closeMobile }}</button>\n                            </div>\n                            <div class="catalog-products catalog-main loader-container" :class="{\'is-loading\': loading}" ref="catalogMain">\n                                <div class="catalog-products__main">\n                                    <Product v-for="product in products" :key="product.id" :data="product"></Product>\n                                </div>\n                                <div class="catalog-products__footer">\n                                    <Pagination\n                                    v-if="activeCategory.elCount"\n                                    :currentPage="page.current"\n                                    :pageSize="page.size"\n                                    :elementCount="activeCategory.elCount"\n                                    @onChangePage="changeCurrentPage"\n                                    ></Pagination>\n                                    <a :href="catalogBtn.url" class="button catalog__button">\n                                        <i class="icon icon--burger"></i>\n                                        {{ catalogBtn.title }}\n                                    </a>\n                                </div>\n                            </div>\n                        '}).mount("#catalogMainWrapper")}))}))}))}(this.DK=this.DK||{},BX,DK,DK,DK);
