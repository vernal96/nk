!function(t,e){"use strict";var n={name:"Counter",props:{sizeId:{type:Number,required:!0},productId:{type:Number,required:!0},cartCount:{type:Number,required:!0},min:{type:Boolean,required:!1,default:!1},startButton:{type:Boolean,required:!1,default:!0}},data:function(){return{lang:{toCart:BX.message.TO_CART},count:"",loading:!1,waitTime:200,waiter:null,requestToken:0}},methods:{add:function(){this.count=+this.count+1,this.runAction()},remove:function(){+this.count&&(this.count=+this.count-1),this.count||(this.count=""),this.runAction()},set:function(){"0"!==this.count&&0!==this.count||(this.count=""),this.runAction()},runAction:function(){var t=this;this.waiter&&clearTimeout(this.waiter),this.waiter=setTimeout((function(){t.loading=!0,t.requestToken++;var e=t.requestToken;BX.ajax.runComponentAction("dk:catalog","cartUpdate",{mode:"class",data:{productId:t.productId,id:t.sizeId,count:+t.count}}).then((function(n){if(e===t.requestToken){var o=n.data.count.value?n.data.count.value:"";t.loading=!1,t.count=o,t.changeCartValues(n.data),t.$emit("onChange",n.data),t.waiter=null,"add"===n.data.type&&t.renderCartMessage(),"add"===n.data.type&&BX.onCustomEvent(window,"onProductCartAdd",{count:t.count,productId:t.productId,sizeId:t.sizeId})}}))}),this.waitTime)},changeCartValues:function(t){document.querySelectorAll(".total-sum").forEach((function(e){e.classList.contains("mini-cart__content")&&(t.total.sum.value?e.classList.remove("mini-cart__content--empty"):e.classList.add("mini-cart__content--empty")),e.textContent="".concat(t.total.sum.format)})),document.querySelectorAll(".mini-cart").forEach((function(e){"add"===t.type?e.classList.add("--shake-add"):"remove"===t.type&&e.classList.add("--shake-remove"),setTimeout((function(){e.classList.remove("--shake-add","--shake-remove")}),500)})),document.querySelectorAll(".total-count").forEach((function(e){e.textContent="".concat(t.total.count.format)}))},renderCartMessage:function(){var t="cartMessage",n=document.getElementById(t);n||(n=e.Methods.createStructure({classes:["cart-message","note","note--success"],inner:"".concat(BX.message.NOTIFY_CART_ADD,' <strong><a href="/cart/" class="simple-link">').concat(BX.message.NOTIFY_TO_CART,"</a></strong>"),id:t}),document.body.append(n)),setTimeout((function(){return n.classList.add("is-active")}),0),setTimeout((function(){return n.classList.remove("is-active")}),2e3)}},emits:["onChange"],mounted:function(){this.count=this.cartCount?this.cartCount:""},template:'\n\t\t<div\n\t\t\tclass="button button--center button--orange button--100 button--long product__button"\n\t\t\t:class="{\'is-loading\': loading}"\n\t\t\tv-if="!count && startButton"\n\t\t\t@click="add"\n\t\t>\n\t\t\t<span class="loader" v-if="loading"></span>\n\t\t\t{{ lang.toCart }}\n\t\t</div>\n\t\t<label class="cart-counter" :class="{\'cart-counter--min\': min}" v-else>\n            <div class="cart-counter__button cart-counter__button--remove" @click="remove"></div>\n            <input type="number" class="cart-counter__count" v-model="count" @keyup="set" @change="set">\n            <div class="cart-counter__button cart-counter__button--add" @click="add"></div>\n        </label>\n\t'};t.Counter=n}(this.DK=this.DK||{},DK);
