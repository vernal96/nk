!function(e){"use strict";var t={name:"Auth",data:function(){return{action:"auth",loading:!1,formType:"",errorMessage:"",storePassword:!1,post:[],get:[],rememberOtp:!1,captchaCode:"",lang:{login:{title:BX.message.LOGIN_TITLE_LOGIN,placeholder:BX.message.LOGIN_PLACEHOLDER_LOGIN},password:{title:BX.message.LOGIN_TITLE_LOGIN,placeholder:BX.message.LOGIN_PLACEHOLDER_LOGIN},storePassword:BX.message.LOGIN_STORE_PASSWORD,submit:BX.message.LOGIN_AUTH_SUBMIT,forgetPassword:BX.message.LOGIN_FORGET_PASSWORD}}},computed:{isLoginForm:function(){return"auth"===this.action}},methods:{submit:function(e){i(e,this,(function(){}),(function(e){if("logout"===e.data.formType)return location.reload(),2}))}},emits:["onUpdateContent"],mounted:function(){o(this)},components:{Back:{name:"Back",title:{type:String,required:!0},form:{type:String,required:!0},params:{type:Object,required:!1},parentLoading:{type:Boolean,required:!0},data:function(){return{loading:!1}},emits:["onLoadingAfter","onLoadingBefore"],methods:{go:function(){o(this,params)}},template:'\n<div style="margin-bottom: 0.2em;">\n    <button class="link" type="button" @click="go">{{ title }}</button>\n</div>\n'},Captcha:{name:"Captcha",props:{code:{type:String,required:!1}},data:function(){return{lang:{title:BX.message.CAPTCHA_TITLE,placeholder:BX.message.CAPTCHA_PLACEHOLDER}}},computed:{url:function(){return"/bitrix/tools/captcha.php?captcha_sid=".concat(this.code)}},template:'\n<div class="form-fieldset form-fieldset--horizontal form-fieldset--min-gap" v-if="code">\n    <input type="hidden" name="captcha_sid" :value="code">\n    <img :src="url" alt="CAPTCHA" class="captcha form-fieldset-item">\n    <label class="input form-fieldset-item" style="width: 100%;">\n        <span class="input__title">{{ lang.title }}</span>\n        <input type="text" name="captcha_word" value="" :placeholder="lang.placeholder"/>\n    </label>\n</div>\n'}},template:'\n<form action="?" @submit="submit" method="post">\n    <div class="modal__form">\n        <div class="note note--error" v-if="errorMessage" v-html="errorMessage"></div>\n        <input type="hidden" :name="postField.key" :value="postField.value" v-for="postField in post">\n        <input type="hidden" name="AUTH_FORM" value="Y">\n        <input type="hidden" name="TYPE" value="AUTH">\n        <template v-if="isLoginForm">\n            <label class="input">\n                 <span class="input__title">{{ lang.login.title }}</span>\n                 <input type="text" name="USER_LOGIN" value="" :placeholder="lang.login.placeholder" autocomplete="off"/>\n            </label>\n            <label class="input">\n                 <span class="input__title">{{ lang.password.title }}</span>\n                 <input type="password" name="USER_PASSWORD" value="" :placeholder="lang.password.placeholder" autocomplete="off"/>\n            </label>\n            <label class="checkbox" v-if="storePassword">\n                 <input type="checkbox" name="USER_REMEMBER" value="Y">\n                 <span class="checkbox__fake"></span>\n                 <span class="checkbox__content">{{ lang.storePassword }}</span>\n            </label>\n        </template>\n        <template v-else-if="isOtpForm">\n            <label class="input">\n                 <span class="input__title">Одноразовый пароль</span>\n                 <input type="text" name="USER_OTP" value=""\n                          placeholder="Введите одноразовый пароль"/>\n            </label>\n            <label class="checkbox" v-if="rememberOtp">\n                 <input type="checkbox" name="OTP_REMEMBER" value="1">\n                 <span class="checkbox__fake"></span>\n                 <span class="checkbox__content">Запомнить код</span>\n            </label>\n        </template>\n        <Captcha :code="captchaCode"></Captcha>\n        </div>\n    <div class="modal__footer">\n        <button type="submit" class="button button--orange button--100" :class="{\'is-loading\': loading}" :disabled="loading">\n            <span class="loader" v-if="loading"></span>\n            {{ lang.submit }}\n        </button>\n        <button class="simple-link" style="font-size: 0.9em;" type="button" @click="getComponent(\'forgotpasswd\', \'forgotpasswd\')" v-if="isLoginForm">{{ lang.forgetPassword }}</button>\n    </div>\n</form>\n'},n={name:"login",data:function(){return{swiper:null,tabs:[{id:"auth",title:BX.message.LOGIN_AUTH},{id:"reg",title:BX.message.LOGIN_REG}],lang:{title:BX.message.LOGIN_TITLE},activeTab:"auth"}},components:{Authorize:{name:"Authorize",data:function(){return{form:t}},components:{Auth:t,FGP:{}},template:'\n<component :is="form"></component>\n'}},methods:{toggleSlide:function(e,t){this.swiper&&(this.swiper.slideTo(e),this.activeTab=t)},updateAutoHeight:function(){var e=this;setTimeout((function(){return e.swiper.updateAutoHeight(100)}),0)}},mounted:function(){this.swiper=new Swiper(this.$refs.swiper,{autoHeight:!0,slidesPerView:1,allowTouchMove:!1,effect:"fade",speed:300,fadeEffect:{crossFade:!0}})},template:'\n<div class="modal__header">\n    <div class="modal__title">{{ lang.title }}</div>\n    <div class="modal__subtitle">\n        <div class="inline-links">\n            <div\n                v-for="tab, index in tabs"\n                class="inline-link"\n                :class="{\'inline-link--is-active\': tab.id === activeTab}"\n                :key="tab.id"\n                @click="toggleSlide(index, tab.id)"\n            >{{ tab.title }}</div>\n        </div>\n    </div>\n</div>\n<div class="modal__forms swiper" ref="swiper">\n    <div class="swiper-wrapper">\n        <div class="swiper-slide">\n            <Authorize @onUpdateContent="updateAutoHeight"></Authorize>\n        </div>\n        <div class="swiper-slide">\n            <Registration @onUpdateContent="updateAutoHeight"></Registration>\n        </div>\n    </div>\n</div>\n'};function a(e,t){"object"===babelHelpers.typeof(t)&&null!==t&&Object.entries(t).forEach((function(t){var n=babelHelpers.slicedToArray(t,2),a=n[0],i=n[1];a in e&&(e[a]=i)}))}function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};e.preventDefault(),t.loading||(t.loading=!0,BX.ajax.runComponentAction("dk:login",t.action,{mode:"class",data:new FormData(e.target),getParameters:o}).then((function(e){n(e),a(t,e.data),t.$emit("onUpdateContent"),t.loading=!1,i(e)})))}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.loading||(e.loading=!0,BX.ajax.runComponentAction("dk:login",e.action,{mode:"class",getParameters:t,method:"GET"}).then((function(t){a(e,t.data),e.$emit("onUpdateContent"),e.loading=!1})))}BX.ready((function(){return BX.Vue3.createApp(n).mount("#authorize")})),e.parseResponseParams=a,e.submit=i,e.getComponent=o}(this.DK=this.DK||{});
